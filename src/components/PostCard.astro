---
import type { CollectionEntry } from 'astro:content';
import FormattedDate from './FormattedDate.astro';
import CategoryBadge from './CategoryBadge.astro';
import TagList from './TagList.astro';
import ReadingTime from './ReadingTime.astro';

interface Props {
	post: CollectionEntry<'blog'>;
	featured?: boolean;
}

const { post, featured = false } = Astro.props;
const { title, description, pubDate, category, tags, readingTime, heroImage } = post.data;
---

<article class={`post-card ${featured ? 'post-card--featured' : ''}`}>
	{heroImage && (
		<a href={`/blog/${post.slug}/`} class="post-card__image-link">
			<img
				class="post-card__image"
				src={heroImage}
				alt={`Cover image for ${title}`}
				loading="lazy"
			/>
		</a>
	)}
	
	<div class="post-card__content">
		<div class="post-card__meta">
			<CategoryBadge categoryId={category} size="sm" />
			<span class="post-card__separator">•</span>
			<FormattedDate date={pubDate} />
			{readingTime && (
				<>
					<span class="post-card__separator">•</span>
					<ReadingTime minutes={readingTime} />
				</>
			)}
		</div>
		
		<h3 class="post-card__title">
			<a href={`/blog/${post.slug}/`} class="post-card__title-link">
				{title}
			</a>
		</h3>
		
		<p class="post-card__description">{description}</p>
		
		{tags && tags.length > 0 && (
			<div class="post-card__tags">
				<TagList tags={tags} size="sm" />
			</div>
		)}
	</div>
</article>

<style>
	.post-card {
		display: flex;
		flex-direction: column;
		height: 100%;
		background-color: var(--color-bg-surface);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-lg);
		overflow: hidden;
		transition: all var(--transition-base);
	}

	.post-card:hover {
		border-color: var(--color-border-hover);
		box-shadow: var(--shadow-md);
		transform: translateY(-2px);
	}

	.post-card--featured {
		border-width: 2px;
		border-color: var(--color-accent);
	}

	.post-card__image-link {
		display: block;
		overflow: hidden;
		aspect-ratio: 16 / 9;
	}

	.post-card__image {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform var(--transition-slow);
	}

	.post-card__image-link:hover .post-card__image {
		transform: scale(1.05);
	}

	.post-card__content {
		display: flex;
		flex-direction: column;
		gap: var(--space-md);
		padding: var(--space-lg);
		flex: 1;
	}

	.post-card__meta {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		flex-wrap: wrap;
		font-size: var(--font-size-sm);
		color: var(--color-text-secondary);
	}

	.post-card__separator {
		color: var(--color-border);
	}

	.post-card__title {
		margin: 0;
		font-size: var(--font-size-xl);
		line-height: var(--line-height-snug);
	}

	.post-card__title-link {
		color: var(--color-text-primary);
		text-decoration: none;
		transition: color var(--transition-fast);
	}

	.post-card__title-link:hover {
		color: var(--color-accent);
	}

	.post-card__description {
		margin: 0;
		color: var(--color-text-secondary);
		line-height: var(--line-height-relaxed);
	}

	.post-card__tags {
		margin-top: auto;
	}

	@media (max-width: 640px) {
		.post-card__content {
			padding: var(--space-md);
		}

		.post-card__title {
			font-size: var(--font-size-lg);
		}
	}
</style>
